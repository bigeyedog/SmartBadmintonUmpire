<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Game 2 double setup</title>

    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link rel="stylesheet" href="setup.css" />
    <link
      rel="stylesheet"
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css"
    />
    <link
      rel="stylesheet"
      href="https://fonts.googleapis.com/css?family=Indie+Flower|Lobster"
    />
    <link
      rel="stylesheet"
      href="https://fonts.googleapis.com/css2?family=Montserrat:ital,wght@0,100;0,200;0,300;0,400;0,500;0,600;0,700;0,800;0,900;1,100;1,200;1,300;1,400;1,500;1,600;1,700;1,800;1,900&family=Noto+Sans+HK:wght@100;300;400;500;700;900&family=Ubuntu:ital,wght@0,300;0,400;0,500;0,700;1,300;1,400;1,500;1,700&display=swap"
    />

    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.7.1/jquery.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"></script>
    <script
      src="https://kit.fontawesome.com/147b2895a5.js"
      crossorigin="anonymous"
    ></script>
  </head>

  <body id="body">
    <div id="upper">
      <div id="upperL1">
        <p class="p" id="displayText"></p>
      </div>
    </div>

    <div id="lower">
      <div id="lowerL2">
        <div id="lowerL2C1">
          <select class="select" name="LUplayer" id="LUplayer" required>
            <option class="option" value="" selected disabled>
              Choose one:
            </option>
            <option class="option" id="LU1" value=""></option>
            <option class="option" id="LU2" value=""></option>
            <option class="option" id="LU3" value=""></option>
            <option class="option" id="LU4" value=""></option>
          </select>
          <!-- <br />
            <img class="playerphoto" src="/bear.png" /> -->
        </div>
        <div id="lowerL2C2"></div>
        <div id="lowerL2C3">
          <select class="select" name="RUplayer" id="RUplayer" required>
            <option class="option" value="" selected disabled>
              Choose one:
            </option>
            <option class="option" id="RU1" value=""></option>
            <option class="option" id="RU2" value=""></option>
            <option class="option" id="RU3" value=""></option>
            <option class="option" id="RU4" value=""></option>
          </select>
          <!-- <br />
            <img class="playerphoto" src="/fox.png" /> -->
        </div>
      </div>

      <div id="lowerL3">
        <div id="lowerL3C1">
          <select class="select" name="LLplayer" id="LLplayer" required>
            <option class="option" value="" selected disabled>
              Choose one:
            </option>
            <option class="option" id="LL1" value=""></option>
            <option class="option" id="LL2" value=""></option>
            <option class="option" id="LL3" value=""></option>
            <option class="option" id="LL4" value=""></option>
          </select>
          <!-- <br />
            <img class="playerphoto" src="/elephant.png" /> -->
        </div>
        <div id="lowerL3C2"></div>
        <div id="lowerL3C3">
          <select class="select" name="RLplayer" id="RLplayer" required>
            <option class="option" value="" selected disabled>
              Choose one:
            </option>
            <option class="option" id="RL1" value=""></option>
            <option class="option" id="RL2" value=""></option>
            <option class="option" id="RL3" value=""></option>
            <option class="option" id="RL4" value=""></option>
          </select>
          <!-- <br />
            <img class="playerphoto" src="/penguin.png" /> -->
        </div>
      </div>

      <!-- <div id="instruction">
          <p id="message">
            Players from the same team should be on the same side (either right
            or left).
          </p>
        </div> -->

      <div id="lowerL4">
        <label id="label">Serving player:</label>
        <select class="select" id="servingPlayer" name="servingPlayer" required>
          <option class="option" value="" selected disabled>Choose one:</option>
          <option class="option" id="SP1" value=""></option>
          <option class="option" id="SP2" value=""></option>
          <option class="option" id="SP3" value=""></option>
          <option class="option" id="SP4" value=""></option>
        </select>
        <br />
      </div>

      <div id="lowerL5">
        <!-- <button type="reset" id="resetbutton">Reset</button>
          <button
            type="button"
            id="homebutton"
            onclick="window.location.href = '/index.html'"
          >
            Home
          </button> -->
        <button type="button" id="submitbutton" onclick="goToGame()">
          Go to game
        </button>
      </div>
    </div>

    <script>
      const teamAp1 = sessionStorage.getItem("teamAp1");
      const teamAp2 = sessionStorage.getItem("teamAp2");
      const teamBp1 = sessionStorage.getItem("teamBp1");
      const teamBp2 = sessionStorage.getItem("teamBp2");
      const gametype = sessionStorage.getItem("gametype");
      const format = sessionStorage.getItem("format");
      const displayText = gametype + ", " + format;
      document.getElementById("displayText").textContent = displayText;
      document.getElementById("LU1").textContent = teamAp1;
      document.getElementById("LU2").textContent = teamAp2;
      document.getElementById("LU3").textContent = teamBp1;
      document.getElementById("LU4").textContent = teamBp2;
      document.getElementById("RU1").textContent = teamAp1;
      document.getElementById("RU2").textContent = teamAp2;
      document.getElementById("RU3").textContent = teamBp1;
      document.getElementById("RU4").textContent = teamBp2;
      document.getElementById("LL1").textContent = teamAp1;
      document.getElementById("LL2").textContent = teamAp2;
      document.getElementById("LL3").textContent = teamBp1;
      document.getElementById("LL4").textContent = teamBp2;
      document.getElementById("RL1").textContent = teamAp1;
      document.getElementById("RL2").textContent = teamAp2;
      document.getElementById("RL3").textContent = teamBp1;
      document.getElementById("RL4").textContent = teamBp2;
      document.getElementById("LL4").textContent = teamBp2;
      document.getElementById("SP1").textContent = teamAp1;
      document.getElementById("SP2").textContent = teamAp2;
      document.getElementById("SP3").textContent = teamBp1;
      document.getElementById("SP4").textContent = teamBp2;
      document.getElementById("LU1").value = teamAp1;
      document.getElementById("LU2").value = teamAp2;
      document.getElementById("LU3").value = teamBp1;
      document.getElementById("LU4").value = teamBp2;
      document.getElementById("RU1").value = teamAp1;
      document.getElementById("RU2").value = teamAp2;
      document.getElementById("RU3").value = teamBp1;
      document.getElementById("RU4").value = teamBp2;
      document.getElementById("LL1").value = teamAp1;
      document.getElementById("LL2").value = teamAp2;
      document.getElementById("LL3").value = teamBp1;
      document.getElementById("LL4").value = teamBp2;
      document.getElementById("RL1").value = teamAp1;
      document.getElementById("RL2").value = teamAp2;
      document.getElementById("RL3").value = teamBp1;
      document.getElementById("RL4").value = teamBp2;
      document.getElementById("SP1").value = teamAp1;
      document.getElementById("SP2").value = teamAp2;
      document.getElementById("SP3").value = teamBp1;
      document.getElementById("SP4").value = teamBp2;
    </script>

    <script>
      $(document).ready(function () {
        const $ruPlayer = $("#RUplayer");
        const $llPlayer = $("#LLplayer");
        const $rlPlayer = $("#RLplayer");
        const $luPlayer = $("#LUplayer");
        const teamAp1 = sessionStorage.getItem("teamAp1");
        const teamAp2 = sessionStorage.getItem("teamAp2");
        const teamBp1 = sessionStorage.getItem("teamBp1");
        const teamBp2 = sessionStorage.getItem("teamBp2");
        // Function to set teammate when a player is selected
        function updateTeammates(selectElement) {
          const selectedValue = selectElement.val();

          // Handle Team A players
          if (selectedValue === teamAp1) {
            if (selectElement.is($ruPlayer)) {
              $rlPlayer.val(teamAp2);
            } else if (selectElement.is($rlPlayer)) {
              $ruPlayer.val(teamAp2);
            } else if (selectElement.is($luPlayer)) {
              $llPlayer.val(teamAp2);
            } else if (selectElement.is($llPlayer)) {
              $luPlayer.val(teamAp2);
            }
          } else if (selectedValue === teamAp2) {
            if (selectElement.is($ruPlayer)) {
              $rlPlayer.val(teamAp1);
            } else if (selectElement.is($rlPlayer)) {
              $ruPlayer.val(teamAp1);
            } else if (selectElement.is($luPlayer)) {
              $llPlayer.val(teamAp1);
            } else if (selectElement.is($llPlayer)) {
              $luPlayer.val(teamAp1);
            }
          }
          // Handle Team B players
          else if (selectedValue === teamBp1) {
            if (selectElement.is($ruPlayer)) {
              $rlPlayer.val(teamBp2);
            } else if (selectElement.is($rlPlayer)) {
              $ruPlayer.val(teamBp2);
            } else if (selectElement.is($luPlayer)) {
              $llPlayer.val(teamBp2);
            } else if (selectElement.is($llPlayer)) {
              $luPlayer.val(teamBp2);
            }
          } else if (selectedValue === teamBp2) {
            if (selectElement.is($ruPlayer)) {
              $rlPlayer.val(teamBp1);
            } else if (selectElement.is($rlPlayer)) {
              $ruPlayer.val(teamBp1);
            } else if (selectElement.is($luPlayer)) {
              $llPlayer.val(teamBp1);
            } else if (selectElement.is($llPlayer)) {
              $luPlayer.val(teamBp1);
            }
          }
        }

        // Set up change event handlers for all player selects
        $ruPlayer
          .add($rlPlayer)
          .add($luPlayer)
          .add($llPlayer)
          .on("change", function () {
            updateTeammates($(this));
          });

        // Initialize any existing values
        if ($ruPlayer.val()) updateTeammates($ruPlayer);
        if ($rlPlayer.val()) updateTeammates($rlPlayer);
        if ($luPlayer.val()) updateTeammates($luPlayer);
        if ($llPlayer.val()) updateTeammates($llPlayer);
      });
    </script>

    <script>
      function goToGame() {
        const luPlayer = document.getElementById("LUplayer").value.trim();
        const ruPlayer = document.getElementById("RUplayer").value.trim();
        const llPlayer = document.getElementById("LLplayer").value.trim();
        const rlPlayer = document.getElementById("RLplayer").value.trim();
        const sPlayer = document.getElementById("servingPlayer").value.trim();

        if (
          luPlayer === "" ||
          ruPlayer === "" ||
          llPlayer === "" ||
          rlPlayer === ""
        ) {
          alert("Please choose player on the court.");
          return;
        }

        const playerArray = [luPlayer, ruPlayer, llPlayer, rlPlayer];
        console.log(playerArray);
        function hasDuplicates(playerArray) {
          return new Set(playerArray).size !== playerArray.length;
        }
        if (hasDuplicates(playerArray)) {
          alert("Wrong player entry on the court!");
          return;
        }

        if (sPlayer === "") {
          alert("Please choose the serving player.");
          return;
        }

        if (sPlayer === luPlayer || sPlayer === rlPlayer) {
          alert("Serving player is on wrong position.");
          return;
        }

        sessionStorage.setItem("luPlayer", luPlayer);
        sessionStorage.setItem("ruPlayer", ruPlayer);
        sessionStorage.setItem("llPlayer", llPlayer);
        sessionStorage.setItem("rlPlayer", rlPlayer);
        sessionStorage.setItem("sPlayer", sPlayer);

        window.location.href = "doubleGame321b.html";
      }
    </script>
  </body>
</html>
